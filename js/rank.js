$(function(){$(".betranking_tab li").click(function(){if(!$(this).hasClass(".current")){$(".points_table").empty();$(".shooter_table tbody").empty();$(".attack_table tbody").empty();$(".schedule_table tbody").empty();$(this).addClass("current").siblings("li").removeClass("current");var b=$("#fitlerItemDiv a.current").attr("name");var a=$("#fitlerItemDiv a.current").html();if($(this).attr("id")=="points"){$(".points_table").show();$(".points_table").siblings(".tab_list").hide();showLoading();$("#title").html(a);rankData(b)}else{if($(this).attr("id")=="shooter"){$(".shooter_table").show();$(".shooter_table").siblings(".tab_list").hide();showLoading();$("#title").html(a);shooterData(b)}}if($(this).attr("id")=="attack"){$(".attack_table").show();$(".attack_table").siblings(".tab_list").hide();showLoading();$("#title").html(a);attackData(b)}if($(this).attr("id")=="schedule"){$(".schedule_table").show();$(".schedule_table").siblings(".tab_list").hide();showLoading();$("#title").html(a);scheduleData(b)}}})});function showLoading(){$("body").append("<div class='loading_wrap'><span class='loading_ico'></span></div>")}function hideLoading(){$(".loading_wrap").remove()}function showTipsPop(a,b){$("body").append("<div class='tips_pop'></div>");$(".tips_pop").show().html(a);setTimeout(function(){$(".tips_pop").hide()},b)}function filterItem(a){if($(a).hasClass("current")){return}$(a).siblings(".current").removeClass("current");$(a).toggleClass("current");$("#filter").data("mmenu").close();$("#points").click()}function rankData(a){$.ajax({type:"post",url:getPath()+"/web/data/point/rank.do",data:"id="+a,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=utf-8",success:function(f){hideLoading();if(f.s==200){if(f.r.length==0){$(".points_table").html("<table class='betranking_table'><tbody><tr><td colspan='8' style='background:#141926'>暂无数据<td></tr></tbody></table>");return}var g="";for(var l in f.r){var i=f.r[l];var d=Number(i.aggrCount);var c=Number(i.groups);var h=Number(i.matchCount);if(d==0&&c==0&&h==0){g+="<table class='betranking_table'><tbody><tr class='nth-title'><td colspan='8' style='background:#141926'>"+i.name+"积分榜</td></tr>";g+="<tr class='nth-head'><td>排名</td><td class='tdleft' style='padding-left:25px;'>球队</td><td>场</td><td>胜</td><td>平</td><td>负</td><td>进/失</td><td>积分</td></tr>";for(var e in i.rankings){var m=i.rankings[e];g+="<tr>";g+="<td>"+m.rank+"</td>";if(m.team_id=="0"){g+="<td>"+m.club_name+"</td>"}else{g+="<td class='tdleft'><img height='20' src='http://img.dongqiudi.com/data/pic/"+m.team_id+".png' />"+m.club_name+"</td>"}g+="<td>"+m.matches_total+"</td>";g+="<td>"+m.matches_won+"</td>";g+="<td>"+m.matches_draw+"</td>";g+="<td>"+m.matches_lost+"</td>";g+="<td>"+m.goals_pro+"/"+m.goals_against+"</td>";g+="<td>"+m.points+"</td>";g+="</tr>"}g+="</tbody></table>"}else{if(d!=0){g+="<table class='betranking_table'><tbody><tr><td colspan='4' style='background:#141926'>"+i.name+"积分榜</td></tr>";for(var e in i.rankings){var m=i.rankings[e];var k="VS";if(m[0].fs_A!=""&&m[0].fs_B!=""){k=m[0].fs_A+":"+m[0].fs_B}g+="<tr><td>总分</td><td>"+m[0].team_A_name+"</td><td>"+k+"</td><td>"+m[0].team_B_name+"</td></tr>";k="VS";if(m[1].fs_A!=""&&m[1].fs_B!=""){k=m[1].fs_A+":"+m[1].fs_B}g+="<tr><td>"+formatTime(m[1].start_play)+"</td><td>"+m[1].team_A_name+"</td><td>"+k+"</td><td>"+m[1].team_B_name+"</td></tr>";k="VS";if(m[2].fs_A!=""&&m[2].fs_B!=""){k=m[2].fs_A+":"+m[2].fs_B}g+="<tr><td>"+formatTime(m[2].start_play)+"</td><td>"+m[2].team_A_name+"</td><td>"+k+"</td><td>"+m[2].team_B_name+"</td></tr>"}g+="</tbody></table>"}else{if(c!=0){g+="<table class='betranking_table'><tbody><tr><td colspan='10' style='background:#141926'>"+i.name+"积分榜</td></tr>";for(var e in i.rankings){var m=i.rankings[e];g+="<tr><td colspan='10' style='background:#1d2537'>"+m.name+"</td></tr>";g+="<tr class='group_title'><td>排名</td><td>球队</td><td>场次</td><td>胜</td><td>平</td><td>负</td><td>进球</td><td>失球</td><td>净胜球</td><td>积分</td></tr>";for(var j in m.rank_list){var b=m.rank_list[j];g+="<tr>";g+="<td>"+b.rank+"</td>";g+="<td>"+b.club_name+"</td>";g+="<td>"+b.matches_total+"</td>";g+="<td>"+b.matches_won+"</td>";g+="<td>"+b.matches_draw+"</td>";g+="<td>"+b.matches_lost+"</td>";g+="<td>"+b.goals_pro+"</td>";g+="<td>"+b.goals_against+"</td>";g+="<td>"+(Number(b.goals_pro)-Number(b.goals_against))+"</td>";g+="<td>"+b.points+"</td>";g+="</tr>"}}g+="</tbody></table>"}else{if(h!=0){g+="<table class='betranking_table'><tbody><tr><td colspan='4' style='background:#141926'>"+i.name+"积分榜</td></tr>";for(var e in i.rankings){var b=i.rankings[e][0];var k="VS";if(b.fs_A!=""&&b.fs_B!=""){k=b.fs_A+":"+b.fs_B}g+="<tr>";g+="<td>"+formatTime(b.start_play)+"</td><td>"+b.team_A_name+"</td><td>"+k+"</td><td>"+b.team_B_name+"</td>";g+="</tr>"}g+="</tbody></table>"}}}}}$(".points_table").html(g)}},error:function(b,d,c){hideLoading();console.log(b.responseText);console.log(b.status);console.log(b.readyState);console.log(b.statusText);console.log(d);console.log(c)}})}function formatTime(a){return a.substring(0,a.length-3)}function shooterData(a){$.ajax({type:"post",url:getPath()+"/web/data/goal/rank.do",data:"id="+a,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=utf-8",success:function(b){hideLoading();if(b.s==200){if(b.r.length==0){$(".shooter_table tbody").html("<tr><td colspan=4 style='background:#141926'>暂无数据<td></tr>");return}var d="";for(var c in b.r){var e=b.r[c];d+="<tr>";d+="<td>"+(parseInt(c)+1)+"</td>";d+="<td>"+e.name+"</td>";d+="<td class='tdleft'>"+e.team_name+"</td>";d+="<td>"+e.count+"</td>";d+="</tr>"}$(".shooter_table tbody").html(d)}},error:function(b,d,c){hideLoading();console.log(b.responseText);console.log(b.status);console.log(b.readyState);console.log(b.statusText);console.log(d);console.log(c)}})}function attackData(a){$.ajax({type:"post",url:getPath()+"/web/data/assist/rank.do",data:"id="+a,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=utf-8",success:function(b){hideLoading();if(b.s==200){if(b.r.length==0){$(".attack_table tbody").html("<tr><td colspan='4' style='background:#141926'>暂无数据<td></tr>");return}var e="";for(var d in b.r){var f=b.r[d];var c=parseInt(d)+1;e+="<tr>";e+="<td>"+c+"</td>";e+="<td>"+f.name+"</td>";e+="<td class='tdleft'>"+f.team_name+"</td>";e+="<td>"+f.count+"</td>";e+="</tr>"}$(".attack_table tbody").html(e)}},error:function(b,d,c){hideLoading();console.log(b.responseText);console.log(b.status);console.log(b.readyState);console.log(b.statusText);console.log(d);console.log(c)}})}function changeSchedule(c){showLoading();$(".schedule_table tbody").empty();var a=c.indexOf("-");if(a==-1){scheduleData("",c)}else{var b=c.substring(0,a);var d=c.substring(a+1,c.length);scheduleData("",b,d)}}var round;var prev;var next;function scheduleData(d,a,c,b){if(b){$(".schedule_pre").removeClass("nodata");$(".schedule_next").removeClass("nodata")}if(!a){a=""}if(!c){c=""}$.ajax({type:"post",url:getPath()+"/web/data/schedule.do",data:"id="+d+"&r="+a+"&p="+c,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=utf-8",success:function(l){hideLoading();if(l.s==200){if((d!=""&&!l.b)||(d==""&&c!=""&&b)){round=l.t;var s=Number(l.r.endnum);var o=Number(l.r.nownum);$(".schedule_title").html("常规赛第"+o+"轮");prev=o-1;if(prev<=0){prev=1;$(".schedule_pre").addClass("nodata")}else{$(".schedule_pre").removeClass("nodata")}next=o+1;if(next>s){next=s;$(".schedule_next").addClass("nodata")}else{$(".schedule_next").removeClass("nodata")}}if(l.b&&d!=""){$(".schedule_pre").addClass("nodata");$(".schedule_next").addClass("nodata");var e=l.b.activeRound;var w="<select class='ybselect' name='ybselect' onchange=changeSchedule(this.value)>";for(var t in l.b.roundList){var v=l.b.roundList[t];var n=v.gameweekTotalsNum;var q=v.activeNums;var u=v.name;if(u.length>15){u=u.substring(0,15)+"..."}if(n=="0"&&q=="0"){if(e==v.round_id){w+="<option selected=selected value="+v.round_id+">"+u+"</option>"}else{w+="<option value="+v.round_id+">"+u+"</option>"}}else{var f=Number(n);var g=Number(q);for(var r=1;r<=f;++r){if(e==v.round_id&&r==g){w+="<option selected=selected value="+v.round_id+"-"+r+">"+u+"第"+r+"轮</option>"}else{w+="<option value="+v.round_id+"-"+r+">"+u+"第"+r+"轮</option>"}}}}w+="</select>";$(".schedule_title").html(w)}if(l.r.matches.length==0){$(".schedule_table tbody").html("<tr><td>暂无数据</td></tr>");return}var p="";for(var k in l.r.matches){var j=l.r.matches[k];var h=j.fs_A+":"+j.fs_B;if(j.fs_A=""||j.fs_B==""){h="VS"}p+="<tr>";p+="<td>"+formatTime(j.start_play)+"</td>";if(j.team_A_id=="0"){p+="<td>"+j.team_A_name+"</td>"}else{p+="<td><img height=20 src='http://img.dongqiudi.com/data/pic/"+j.team_A_id+".png'><br>"+j.team_A_name+"</td>"}p+="<td class='tdleft'>"+h+"&nbsp;</td>";if(j.team_B_id=="0"){p+="<td>"+j.team_B_name+"</td>"}else{p+="<td><img height=20 src='http://img.dongqiudi.com/data/pic/"+j.team_B_id+".png'><br>"+j.team_B_name+"</td>"}p+="</tr>"}$(".schedule_table tbody").html(p);$(".schedule_table img").error(function(){$(this).hide()});selectBox()}},error:function(e,g,f){hideLoading();console.log(e.responseText);console.log(e.status);console.log(e.readyState);console.log(e.statusText);console.log(g);console.log(f)}})}$(function(){$(".schedule_pre").click(function(){if(!$(this).hasClass("nodata")){showLoading();$(".schedule_table tbody").empty();scheduleData("",round,prev,true)}});$(".schedule_next").click(function(){if(!$(this).hasClass("nodata")){showLoading();$(".schedule_table tbody").empty();scheduleData("",round,next,true)}})});function selectBox(){$("select[name='ybselect']").selectbox({effect:"slide"})};