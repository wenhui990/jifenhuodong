var token=0;var aid=0;var gid=0;function showLoading(){$("body").append("<div class='loading_wrap'><span class='loading_ico'></span></div>")}function hideLoading(){$(".loading_wrap").remove()}function showTipsPop(a,b){$("body").append("<div class='tips_pop'></div>");$(".tips_pop").show().html(a);setTimeout(function(){$(".tips_pop").hide()},b)}function searchBet(a){showLoading();$.ajax({type:"post",url:getPath()+"/web/activity/query.do",data:"type="+a,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=utf-8",success:function(b){hideLoading();if(b.s==200){token=b.t;aid=b.b.id;gid=b.b.gid}searchBetCallback(b);checkClick()},error:function(b,d,c){hideLoading();console.log(b.responseText);console.log(b.status);console.log(b.readyState);console.log(b.statusText);console.log(d);console.log(c)}})}function searchBetCallback(g){if(g.s==200&&g.r){var h="";if(g.r.size>0){h+="<div class='data_block_header up'><span>本次竞猜截止时间: "+formatDateYMDHM(g.b.stop_time)+"</span>共 <span>"+g.r.size+"</span>场比赛</span></div>";h+="<div name='outer'>";for(var j in g.r.list){var f=g.r.list[j];h+="<div class='one_match' id='"+f.mid+"' name='"+f.matchType+"'>";h+="<div class='item_block' >";h+="<div class='item_head'>";h+="<div class='item_head_right tz_block'>";h+="<span>";if(f.hlogo){h+="<img src='"+f.hlogo+"'><br />"}else{h+="<i style='padding-top:27px;display:inline-block;'> </i><br/>"}h+="<b>"+f.guest+"</b>(客)";h+="</span>";h+="<div class='item_body_first'>";h+="<p>"+f.league+"</p>";h+="<p>"+f.matchTime+"</p>";h+="<p>"+f.alias+"</p>";h+="</div>";h+="<span>";if(f.glogo){h+="<img src='"+f.glogo+"'><br />"}else{h+="<i style='padding-top:27px;display:inline-block;'> </i><br/>"}h+="<b>"+f.home+"</b>(主)</span>";h+="</span>";h+="</div>";h+="<div class='clearf'></div>";h+="</div>";h+="</div>";var e="";var c="";var b="";var p="";var o="";var n="";var l="";var k="";var i="";for(var a in f.bet){var d=f.bet[a];if(d.type==1){e+="<div class='item_block'>";e+="<div class='sfpShow tab_list data_block'>";e+="<table class='sfpTable'><tbody>";e+="<tr class='rang_title green_title'><td colspan='4'>胜平负</td></tr>";e+="<tr title="+d.type+">";e+="<td name='"+f.mid+"' class='oddsItems firsttd' title='3'>胜<br/><label>"+d.odds.r3+"</label></td>";e+="<td name='"+f.mid+"' class='oddsItems' title='1'>平<br/><label>"+d.odds.r1+"</label></td>";e+="<td name='"+f.mid+"' class='oddsItems thirdtd' title='0'>负<br/><label>"+d.odds.r0+"</label></td>";e+="</tr></tbody></table></div></div>"}else{if(d.type==2){c+="<div class='item_block'>";c+="<div class='sfpShow tab_list data_block'>";c+="<table class='sfpTable'><tbody>";if(d.let>0){c+="<tr class='rang_title red_title'><td colspan='4'>让球 "+d.let+"胜平负</td></tr>"}else{c+="<tr class='rang_title green_title'><td colspan='4'>让球 "+d.let+"胜平负</td></tr>"}c+="<tr title="+d.type+">";c+="<td name='"+f.mid+"' class='oddsItems firsttd' title='3'>让胜<br/><label>"+d.odds.r3+"</label></td>";c+="<td name='"+f.mid+"' class='oddsItems' title='1'>让平<br/><label>"+d.odds.r1+"</label></td>";c+="<td name='"+f.mid+"' class='oddsItems thirdtd' title='0'>让负<br/><label>"+d.odds.r0+"</label></td>";c+="</tr></tbody></table></div></div>"}else{if(d.type==3){b+="<table class='mainTbl tab_list totalballShow' width='100%' cellspacing='0' cellpadding='0'><tbody>";b+="<tr class='rang_title green_title'><td colspan='4'>总进球数</td></tr>";b+="<tr class='crsOddsTr' style='display: table-row;'><td colspan='5' class='td_padding ttgOdds'><table class='crsOdds' dataindex='0_0' width='100%'><tbody><tr><td title="+d.type+">";b+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-l' title='0'><div>0</div><label>"+d.odds.s0+"</label></span>";b+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='1'><div>1</div><label>"+d.odds.s1+"</label></span>";b+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='2'><div>2</div><label>"+d.odds.s2+"</label></span>";b+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='3'><div>3</div><label>"+d.odds.s3+"</label></span>";b+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-r' title='4'><div>4</div><label>"+d.odds.s4+"</label></span>";b+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-l' title='5'><div>5</div><label>"+d.odds.s5+"</label></span>";b+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='6'><div>6</div><label>"+d.odds.s6+"</label></span>";b+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-r' title='7'><div>7+</div><label>"+d.odds.s7+"</label></span>";b+="</td></tr></tbody></table></td></tr>";b+="</tbody></table>"}else{if(d.type==4){p+="<table id='scoreSelectShow' class='mainTbl tab_list scoreShow' width='100%'><tbody>";p+="<tr class='rang_title green_title'><td colspan='4'>比分</td></tr>";p+="<tr class='crsOddsTr' style='display: table-row;'><td colspan='5' class='td_padding'><table class='crsOdds' dataindex='0_0' width='100%' cellspacing='0' cellpadding='0'><tr><td title="+d.type+" style='text-align:left;'>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-l' title='1_0'><div>1:0</div><label>"+d.odds.s1_0+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='2_0'><div>2:0</div><label>"+d.odds.s2_0+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='2_1'><div>2:1</div><label>"+d.odds.s2_1+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='3_0'><div>3:0</div><label>"+d.odds.s3_0+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-r' title='3_1'><div>3:1</div><label>"+d.odds.s3_1+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-l' title='3_2'><div>3:2</div><label>"+d.odds.s3_2+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='4_0'><div>4:0</div><label>"+d.odds.s4_0+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='4_1'><div>4:1</div><label>"+d.odds.s4_1+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='4_2'><div>4:2</div><label>"+d.odds.s4_2+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-r' title='5_0'><div>5:0</div><label>"+d.odds.s5_0+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-l' title='5_1'><div>5:1</div><label>"+d.odds.s5_1+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='5_2'><div>5:2</div><label>"+d.odds.s5_2+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-r' title='8'><div>胜其他</div><label>"+d.odds.s+"</label></span>";p+="</td></tr><tr><td title="+d.type+" style='text-align:left;'>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-l' title='0_0'><div>0:0</div><label>"+d.odds.s0_0+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='1_1'><div>1:1</div><label>"+d.odds.s1_1+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='2_2'><div>2:2</div><label>"+d.odds.s2_2+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='3_3'><div>3:3</div><label>"+d.odds.s3_3+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-r' title='7'><div>平其他</div><label>"+d.odds.p+"</label></span>";p+="</td></tr><tr><td  title="+d.type+" style='text-align:left;'>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-l' title='0_1'><div>0:1</div><label>"+d.odds.s0_1+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='0_2'><div>0:2</div><label>"+d.odds.s0_2+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='1_2'><div>1:2</div><label>"+d.odds.s1_2+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='0_3'><div>0:3</div><label>"+d.odds.s0_3+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-r' title='1_3'><div>1:3</div><label>"+d.odds.s1_3+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-l' title='2_3'><div>2:3</div><label>"+d.odds.s2_3+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='0_4'><div>0:4</div><label>"+d.odds.s0_4+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='1_4'><div>1:4</div><label>"+d.odds.s1_4+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='2_4'><div>2:4</div><label>"+d.odds.s2_4+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-r' title='0_5'><div>0:5</div><label>"+d.odds.s0_5+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-l' title='1_5'><div>1:5</div><label>"+d.odds.s1_5+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep' title='2_5'><div>2:5</div><label>"+d.odds.s2_5+"</label></span>";p+="<span name='"+f.mid+"' class='oddsItem oddsItems oddsItemKeep radius3-r' title='6'><div>负其他</div><label>"+d.odds.f+"</label></span>";p+="</td></tr></table>";p+="</tbody></table>"}else{if(d.type==5){o+="<table id='halfSelectShow' class='mainTbl tab_list halfShow' width='100%' cellspacing='0' cellpadding='0'>";o+="<tr class='rang_title green_title'><td colspan='4'>半全场</td></tr>";o+="<tr class='crsOddsTr'><td colspan='5'class='td_padding ttgOdds'style='width:480px;'><table class='crsOdds'dataindex='0_0'width='100%'><tbody><tr><td title="+d.type+">";o+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-l' title='33'><div>胜胜</div><label>"+d.odds.r33+"</label></span>";o+="<span name='"+f.mid+"' class='halfItem oddsItems' title='10'><div>胜平</div><label>"+d.odds.r10+"</label></span>";o+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-r' title='30'><div>胜负</div><label>"+d.odds.r30+"</label></span>";o+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-l' title='13'><div>平胜</div><label>"+d.odds.r13+"</label></span>";o+="<span name='"+f.mid+"' class='halfItem oddsItems' title='11'><div>平平</div><label>"+d.odds.r11+"</label></span>";o+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-r' title='10'><div>平负</div><label>"+d.odds.r10+"</label></span>";o+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-l' title='03'><div>负胜</div><label>"+d.odds.r03+"</label></span>";o+="<span name='"+f.mid+"' class='halfItem oddsItems' title='01'><div>负平</div><label>"+d.odds.r01+"</label></span>";o+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-r' title='00'><div>负负</div><label>"+d.odds.r00+"</label></span>";o+="</td></tr></tbody></table></td></tr>";o+="</tbody></table>"}else{if(d.type==11){n+="<div class='item_block'>";n+="<table class='basketSf'><tbody>";n+="<tr class='rang_title green_title'><td colspan='4'>胜负</td></tr>";n+="<tr title="+d.type+">";n+="<td name='"+f.mid+"' class='oddsItems firsttd' title='0'>主负<br/><label>"+d.odds.r0+"</label></td>";n+="<td name='"+f.mid+"' class='oddsItems thirdtd' title='3'>主胜<br/><label>"+d.odds.r3+"</label></td>";n+="</tr>";n+="</tbody></table>";n+="</div>"}else{if(d.type==12){l+="<div class='item_block'>";l+="<table class='basketSf'><tbody>";if(d.let>0){l+="<tr class='rang_title red_title' title="+d.type+"><td colspan='3'>主让"+d.let+"胜负</td></tr>"}else{if(d.let<=0){l+="<tr class='rang_title green_title' title="+d.type+"><td colspan='3'>主让"+d.let+"胜负</td></tr>"}}l+="<tr title="+d.type+">";l+="<td name='"+f.mid+"' class='oddsItems firsttd' title='0'>主负<br><label>"+d.odds.r0+"</label></td>";l+="<td name='"+f.mid+"' class='oddsItems thirdtd' title='3'>主胜<br><label>"+d.odds.r3+"</label></td>";l+="</tr>";l+="</tbody></table>";l+="</div>"}else{if(d.type==13){k+="<table id='sfcSelectShow' class='mainTbl tab_list sfcShow' width='100%' cellspacing='0' cellpadding='0'>";k+="<tr class='rang_title green_title'><td colspan='4'>胜分差</td></tr>";k+="<tr class='crsOddsTr'><td colspan='5'class='td_padding ttgOdds'style='width:480px;'>";k+="<table id="+f.mid+" class='crsOdds' width='100%'><tbody>";k+="<tr><td title="+d.type+">";k+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-l' title='1_5_k'><div>客胜1-5</div><label>"+d.odds.r1_5_k+"</label></span>";k+="<span name='"+f.mid+"' class='halfItem oddsItems' title='6_10_k'><div>客胜6-10</div><label>"+d.odds.r6_10_k+"</label></span>";k+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-r' title='11_15_k'><div>客胜11-15</div><label>"+d.odds.r11_15_k+"</label></span>";k+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-l' title='16_20_k'><div>客胜16-20</div><label>"+d.odds.r16_20_k+"</label></span>";k+="<span name='"+f.mid+"' class='halfItem oddsItems' title='21_25_k'><div>客胜21-25</div><label>"+d.odds.r21_25_k+"</label></span>";k+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-r' title='26_k'><div>客胜26+</div><label>"+d.odds.r26_k+"</label></span>";k+="</td></tr>";k+="<tr><td title="+d.type+">";k+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-l' title='1_5_z'><div>主胜1-5</div><label>"+d.odds.r1_5_z+"</label></span>";k+="<span name='"+f.mid+"' class='halfItem oddsItems' title='6_10_z'><div>主胜6-10</div><label>"+d.odds.r6_10_z+"</label></span>";k+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-r' title='11_15_z'><div>主胜11-15</div><label>"+d.odds.r11_15_z+"</label></span>";k+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-l' title='16_20_z'><div>主胜16-20</div><label>"+d.odds.r16_20_z+"</label></span>";k+="<span name='"+f.mid+"' class='halfItem oddsItems' title='21_25_z'><div>主胜21-25</div><label>"+d.odds.r21_25_z+"</label></span>";k+="<span name='"+f.mid+"' class='halfItem oddsItems radius3-r' title='26_z'><div>主胜26+</div><label>"+d.odds.r26_z+"</label></span>";k+="</td></tr></tbody></table></td></tr>";k+="</tbody></table>"}else{if(d.type=14){i+="<div class='item_block'>";i+="<table class='basketSf' id="+f.mid+"><tbody>";i+="<tr class='rang_title green_title'><td colspan='4'>大小分</td></tr>";i+="<tr class='rang_title red_title' title="+d.type+"><td colspan='3'>["+d.pre+"]</td></tr>";i+="<tr title="+d.type+">";i+="<td name='"+f.mid+"' class='oddsItems radius3-l' title='big'>大分<br><label>"+d.odds.big+"</label></td>";i+="<td name='"+f.mid+"' class='oddsItems radius3-r' title='small'>小分<br><label>"+d.odds.small+"</label></td>";i+="</tr>";i+="</tbody></table>";i+="</div>"}}}}}}}}}}h+=e+c+b+p+o+n+l+k+i;h+="<div class='clearf'></div>";h+="</div>";h+="</div>";h+="</div>"}h+="</div></div>"}else{h="暂无比赛"}$("#matchDiv").html(h)}else{if(g.s==501){$("#matchDiv").html("<div class='login_pop'>去<a href='"+g.r+"'>登录</a></div>")}else{showTipsPop(g.r,"2000")}}}function checkClick(){$(".oddsItems").click(function(){if($(this).hasClass("checked")){$(this).removeClass("checked")}else{var a=$(this).attr("name");$("#"+a).find(".oddsItems.checked").each(function(){$(this).removeClass("checked")});$(this).addClass("checked")}})}function bet(a){var b=new Array();var d=true;$("div.one_match").each(function(){var e=new Array();$(this).find(".oddsItems.checked").each(function(f){if(f==0){e.push($(this).parent().attr("title"))}e.push($(this).attr("title"))});if(e.length>0){b.push($(this).attr("id")+":"+e.join(","))}else{d=false;showTipsPop("所有赛事均需要竞猜","2000");return false}});if(!d){return}if(b.length<1){showTipsPop("获取竞猜信息失败","2000");return}var c=b.join(";");showLoading();$.ajax({type:"post",url:getPath()+"/web/activity/bet.do",data:{betInfo:c,t:token,aid:aid,gid:gid,type:a},dataType:"json",contentType:"application/x-www-form-urlencoded; charset=utf-8",success:function(e){hideLoading();if(e.s==200&&e.r){showTipsPop(e.r,"2000");setTimeout(function(){location.href=getPath()+"/htmlwx/hd_bet_user.html"},2000)}else{if(e.s==508){$("#matchDiv").html(e.r+"请<input type=button value='刷新' onclick='location.reload()'>页面")}else{if(e.s==501){$("#matchDiv").html("<div class='login_pop'>去<a href='"+e.r+"'>登录</a></div>")}else{if(e.s==510){showTipsPop(e.r,"2000");setTimeout(function(){location.href=getPath()+"/htmlwx/hd_bet_user.html"},2000)}else{showTipsPop(e.r,"2000")}}}}},error:function(e,g,f){hideLoading();console.log(e.responseText);console.log(e.status);console.log(e.readyState);console.log(e.statusText);console.log(g);console.log(f)}})};